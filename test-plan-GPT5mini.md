# HOTEL PLANISPHERE - テストプラン (GPT5mini)

## 概要
本ドキュメントは、学習用ホテル予約サイト「HOTEL PLANISPHERE」(https://hotel-example-site.takeyaqa.dev/ja/) に対する機能テストおよび主要ユーザーフローの検証計画です。目標は主要機能の回帰検証と、UX・入力バリデーション・セッション管理・レスポンシブ性の確認です。

想定開始状態: ブラウザはクリーン（Cookie/LocalStorage/SessionStorageは空）で、ネットワーク接続が可能であること。

注意: このサイトは学習用のサンプルで、データはクライアント側（Cookie/LocalStorage）に保存されます。フォーム送信内容はURLに付与される点に注意してテストを行ってください。

---

## 目次
1. 前提・テスト環境
2. テストデータ
3. シナリオ一覧（優先度順）
4. 各シナリオ詳細（手順・期待結果・前提・成功/失敗基準）
5. 実行上の注意・クリーンアップ

---

## 1. 前提・テスト環境
- ブラウザ: Google Chrome 最新（検証用）。追加で Firefox / Safari を推奨。
- ビューポート: デスクトップ 1280x800、モバイル iPhone 12 Pro 相当 (390x844)
- 初期状態: ブラウザのストレージとCookieはクリア（テストごとにリセット）
- ネットワーク: 外部へのアクセスが許可されていること（サイトへ接続できること）

## 2. テストデータ
- 既存ユーザ一覧（サイト内に掲示されているもの）
  - ichiro@example.com / password （プレミアム）
  - sakura@example.com / pass1234 （一般）
  - jun@example.com / pa55w0rd! （プレミアム）
  - yoshiki@example.com / pass-pass （一般）
- 新規登録用（テスト実行時は毎回ユニークなメールを使用）
  - メール: test+<タイムスタンプ>@example.com
  - パスワード: Test123!
  - 氏名: 自動生成（例: テスト 太郎）

---

## 3. シナリオ一覧（優先度）
- 高: ナビゲーション / 既存ユーザログイン / 新規会員登録 / 宿泊予約（一般・プレミアム）
- 中: 入力バリデーション（メール・パスワード・予約フォーム） / セッション永続性
- 低: レスポンシブ表示 / マイページのアイコンクロップと退会（削除）

---

## 4. 各シナリオ詳細
以下の各シナリオでは、ステップは順序立てて番号付けしています。前提は各ケースの先頭に記載。成功基準・失敗条件を明確にしています。

### TC-01: ナビゲーションの基本検証
- 優先度: 高
- 前提: 初期状態（未ログイン）
- 手順:
  1. トップページ (https://hotel-example-site.takeyaqa.dev/ja/) を開く
  2. ナビゲーションの「ホーム」リンクをクリック
  3. ナビゲーションの「宿泊予約」リンクをクリック
  4. ナビゲーションの「会員登録」リンクをクリック
  5. 「ログイン」ボタンをクリック
- 期待結果:
  - 各クリックで適切なページに遷移する（URLのパス・ページ内の主要見出しで検証）
  - エラーや404が発生しない
- 成功基準: すべてのリンク遷移が正常
- 失敗条件: いずれかのリンクで期待したページが表示されない、またはJSエラー/ネットワークエラーが発生する

### TC-02: 既存ユーザによるログイン（プレミアム）
- 優先度: 高
- 前提: 未ログイン
- テストデータ: ichiro@example.com / password
- 手順:
  1. トップページで「ログイン」をクリック
  2. メールとパスワードを入力してサブミット
  3. マイページへ遷移することを確認
- 期待結果:
  - ログイン成功メッセージが表示される（またはマイページの見出しが表示される）
  - Cookieにセッション情報が保存される
  - マイページに「プレミアム会員」等のランク表記がある
- 成功基準: ログイン後にマイページへ到達し、会員ランクが表示される
- 失敗条件: 認証エラー、無限リダイレクト、またはページが正しく描画されない

### TC-03: 新規会員登録（Happy Path）
- 優先度: 高
- 前提: 未ログイン、LocalStorage/Cookieは空
- テストデータ: test+<timestamp>@example.com, Test123!
- 手順:
  1. トップページから「会員登録」を開く
  2. 必須フィールドを入力（メール、パスワード、パスワード確認、氏名等）
  3. 「登録」ボタンをクリック
  4. 登録後にマイページへ遷移することを確認
- 期待結果:
  - 登録成功メッセージが表示される
  - 入力データがLocalStorageに保存されている
  - マイページに登録した情報が表示される
- 成功基準: 登録→自動ログイン→マイページでデータ確認ができる
- 失敗条件: バリデーションエラー、既存ユーザー重複警告（想定外）、登録後にログインされない

### TC-04: 予約フロー - プレミアム会員での予約（動的計算検証）
- 優先度: 高
- 前提: プレミアム会員でログイン済（例: ichiro@example.com）
- 手順:
  1. 「宿泊予約」へ移動
  2. プレミアム向けプランが表示されていることを確認
  3. あるプランの「予約」リンク/ボタンをクリック（新規ウィンドウで開く場合はウィンドウ間の制御を行う）
  4. 日付、宿泊数、人数、オプション（朝食等）を入力
  5. 合計金額が入力内容に応じて動的に更新されることを確認（例: 人数を増やすと合計が増える）
  6. 「予約確認」→「予約確定」を実行
- 期待結果:
  - 合計金額が計算式に従い正しく表示される
  - 予約完了ダイアログが表示される
  - 確認画面に入力した内容が正しく表示される
- 成功基準: 動的計算が正しく動作し、予約が完了する
- 失敗条件: 計算が誤る、予約画面がクラッシュ、または確認画面と入力が不一致

### TC-05: 予約フロー - 未ログイン/一般会員の表示差分
- 優先度: 高
- 前提: 非ログイン状態、または一般会員（sakura@example.com）
- 手順:
  1. 宿泊プラン一覧を開く
  2. プレミアム限定プランが非表示、または購入不可であることを確認
  3. 一般向けプランで予約フローを実行
- 期待結果:
  - ランクに応じたプラン表示の差分が確認できる
  - 予約は正常に完了する
- 成功基準: 表示制御が正しく行われる
- 失敗条件: ランクに関係なくすべてのプランが表示される、またはアクセス権制御に漏れがある

### TC-06: 入力バリデーション - 主要ケース
- 優先度: 中
- 前提: 各フォーム画面
- ケースと手順:
  A. メール欄に空文字を入力して送信 → 必須エラーメッセージ
  B. 無効なメールフォーマット（"user_at_example"）を入力 → フォーマットエラー
  C. パスワード最小長未満（例: 3文字） → 長さエラー
  D. パスワードと確認用が一致しない → 不一致エラー
  E. 予約日を過去日に設定 → 日付エラー
  F. 宿泊数/人数を許容範囲外へ設定 → 範囲エラー
- 期待結果:
  - 適切なエラーメッセージが表示され、フォーム送信がブロックされる
- 成功基準: 各ネガティブケースで正しいバリデーションが働く
- 失敗条件: 不正データでフォーム送信が成功する、もしくはエラーメッセージが分かりにくい

### TC-07: セッション・永続性の検証
- 優先度: 中
- 前提: ログイン済
- 手順:
  1. ログイン
  2. ページ更新（F5）でセッション維持を確認
  3. 新しいタブでサイトを開きログイン状態を確認
  4. ブラウザを閉じて再起動（必要であればCookieをクリアせず再オープン）してログイン状態を確認
- 期待結果:
  - Cookie/SessionStorageに保存された情報により、ある程度の永続性がある（サイト仕様に従う）
- 成功基準: ページ更新でログアウトにならない
- 失敗条件: 直ちにログアウト状態に戻る（仕様と異なる場合）

### TC-08: レスポンシブ表示の検証
- 優先度: 低〜中
- 前提: なし
- 手順:
  1. デスクトップ幅（1280x800）でトップ→主要画面を確認
  2. モバイル幅（iPhone 12 Pro）でトップ→主要画面を確認
  3. ナビゲーションの開閉、フォーム入力、ボタンタップを確認
- 期待結果:
  - レイアウト崩れがない
  - タップ領域が十分で操作できる
- 成功基準: 主要フローがモバイルでも完了できる
- 失敗条件: メニューやフォームが操作不可能、重要情報が見切れる

### TC-09: マイページ - 退会（データ削除）フロー
- 優先度: 低
- 前提: 新規登録したユーザー（TC-03）
- 手順:
  1. マイページで「退会」/「情報削除」を実行
  2. LocalStorageのユーザーデータが削除されているか確認
  3. 同じメールで再度ログイン・登録が出来るか確認
- 期待結果:
  - データが削除され、同メールで再登録が可能
- 成功基準: ユーザー情報がLocalStorageから消える
- 失敗条件: データが残存する、退会処理でエラーが出る

---

## 5. 実行上の注意・クリーンアップ
- テストごとにCookie/LocalStorage/SessionStorageをクリアして独立性を保つ
- 登録テストではユニークなメールを使う（テスト用タグ + タイムスタンプ）
- フォーム送信内容がURLに付加されるため、実行ログを扱う際は取り扱いに注意する

---

## 6. 成果物と成功定義
- 成果物: Markdownテストプラン（このファイル）、実行時に得られた不具合レポート（別途）
- 合格基準: 高優先度テスト(TC-01〜TC-05)の全パス
- 受入停止条件: 高優先度テストで致命的不具合が1件でも存在する場合

---

## 7. 追加提案（短期で可能な改善）
- Playwright などでスモークテストを自動化する（ナビゲーション、ログイン、予約完了の3ケース）
- テスト実行用の小さなユーティリティ（ユニークメール生成）を用意すると安定する


---

ファイルを保存しました: `test-plan-GPT5mini.md`。次は、このプランに基づく自動化テスト（Playwright）の初期スモークテストを作成しましょうか？